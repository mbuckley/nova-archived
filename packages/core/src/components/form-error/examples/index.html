<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Nova Core - Form Error Examples</title>
    <link rel="shortcut icon" type="image/png" href="../../../favicon.png" />

    <script type="module" src="../../../../../dist/core/core.esm.js"></script>
    <script nomodule src="../../../../../dist/core.js"></script>
    <link rel="stylesheet" type="text/css" href="../../../../../dist/core/core.css" />
  </head>

  <body>
    <nova-example label="Form errors">
      <clio-form novalidate="true">
        <fieldset>
          <clio-input name="min-max-input" required="true" label="Min &gt;= 5 & max =&lt; 15 length"></clio-input>

          <br />

          <clio-textarea name="required-textarea" required="true" label="Required Textarea"></clio-textarea>

          <br />

          <clio-select id="select-role" name="role-selection" label="Select a role" required="true"></clio-select>

          <br />

          <clio-input
            name="required-input"
            required="true"
            label="Default validator - (field is required)"
            sub-label="This is a sub-label for the input."
          ></clio-input>
          <br />

          <clio-input name="colour-input" required="true" label="Colour validator"></clio-input>
          <br />

          <clio-input name="combined-input" required="true" label="Combined validator"></clio-input>
        </fieldset>

        <br />
        <clio-button type="submit">submit</clio-button>
        <clio-button onclick="testValidate()">validate</clio-button>
      </clio-form>
    </nova-example>

    <script>
      var minMaxInput = document.querySelector("clio-input[name='min-max-input']");
      minMaxInput.validationRules = [{ name: "length", options: { min: 5, max: 15 } }];

      var requiredInput = document.querySelector("clio-input[name='required-input']");
      requiredInput.validationRules = [{ name: "required" }];

      var requiredTextarea = document.querySelector("clio-textarea[name='required-textarea']");

      function colourValidator() {
        var acceptableColours = ["red", "yellow", "blue", "green", "purple", "white", "black"];
        return {
          validate: function(value) {
            return acceptableColours.includes(value);
          },
          errorMessage: "Please select a valid colour. ex. " + acceptableColours.join(", "),
        };
      }
      var colourInput = document.querySelector("clio-input[name='colour-input']");

      colourInput.validationRules = [{ validator: colourValidator }];

      var combinedInput = document.querySelector("clio-input[name='combined-input']");
      combinedInput.validationRules = [
        { name: "required" },
        { name: "length", options: { min: 5, max: 15 } },
        { validator: colourValidator },
      ];

      function onInputHandler(ev, selectElement, items) {
        const searchTerm = ev.detail.value.toLowerCase();
        const filteredItems = items.filter(function(item) {
          return item.label.toLowerCase().indexOf(searchTerm) === 0;
        });
        selectElement.items = filteredItems;
      }

      const requiredSelect = document.querySelector("clio-select");
      const selectRole = document.getElementById("select-role");
      const roles = [
        { label: "Associate", value: 1 },
        { label: "Liaison", value: 2 },
        { label: "Consultant", value: 3 },
      ];
      selectRole.items = roles;
      selectRole.addEventListener("clioInput", function(e) {
        onInputHandler(e, selectRole, roles);
      });

      var form = document.querySelector("clio-form");
      form.addEventListener("clioSubmit", function(event) {
        alert("Form submitted");
      });

      function testValidate() {
        form.validate();
      }
    </script>
  </body>
</html>
